{%- assign back = page.dir | split: "/" -%}
{%- if back.size == 4 and page.dir contains 'city' or page.dir contains 'town' -%}
{%- assign size = back | size | minus:0 -%}
{%- elsif back.size == 5 and page.dir contains 'city' or page.dir contains 'town' -%}
{%- assign size = back | size | minus:1 -%}
{%- elsif back.size == 3 -%}
{%- assign size = back | size | minus:-1 -%}
{%- elsif back.size == 4 -%}
{%- assign size = back | size | minus:0 -%}
{%- endif -%}
{%- assign dir = back | slice: 0, size | join: '/' | append: '/' -%}
{%- assign ps = site.pages | sort: 'dir' | where_exp: 'i', 'i.url contains dir and i.url == dir' -%}
{%- for p in ps limit:1 -%}{%- assign location = p.breadcrumb -%}{%- endfor -%}
