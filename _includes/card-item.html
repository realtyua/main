{%- assign records = number -%}

{%- capture navitemtitle -%}
  {%- if slug == 'apartment' -%}
    {{ one.navtitle }} і частини квартир та окремі кімнати у квартирі або гуртожитку
  {%- elsif slug == 'commercial' -%}
    Нежитлова і {{ one.navtitle | downcase }} для ведення підприємницької діяльності
  {%- elsif slug == 'developer' -%}
    Місцеві {{ one.navtitle | downcase }} нерухомості і новобудови та житлові комплекси
  {%- elsif slug == 'garage' -%}
    Окремі та спільні {{ one.navtitle | downcase }} і паркувальні місця над землею та під землею
  {%- elsif slug == 'house' -%}
    Великі і маленькі {{ one.navtitle | downcase }} іх окремі частини та відокремлені кімнати у будинку
  {%- elsif slug == 'land' -%}
    {{ one.navtitle }} для сільського господарства і земельні ділянки для будівництва
  {%- elsif slug == 'realtor' -%}
    Місцеві {{ one.navtitle | downcase }} з купівлі, продажу і оренди нерухомості
  {%- elsif slug == 'rent' -%}
   Подобова і довгострокова {{ one.navtitle | downcase }} квартир, будинків, приміщень, земелі
  {%- else -%}
    {%- if one.navtitle -%}
      {{ one.navtitle }}
    {%- elsif one.breadcrumb -%}
      {{ one.breadcrumb }}
    {%- else -%}
      {{ one.title }}
    {%- endif -%}
  {%- endif -%}
{%- endcapture -%}

{%- capture ncomplexes -%}
  {%- if slug == 'developer' -%}
    {%- assign objects = site.html_pages | where_exp: "i", "i.dir contains thehere and i.url contains 'object' and i.layout == 'object'" -%}
    <span class="badge text-white p-0 m-1">
      <span class="bg-primary py-1 px-2 rounded-left">Об'єктів</span>
      <span class="py-1 px-2 bg-info rounded-right">{{ objects | size }}</span>
    </span>
  {%- endif -%}
{%- endcapture -%}

{%- capture nsellers -%}
  {%- if slug == 'developer' -%}
    {%- assign developers = site.html_pages | where_exp: "i", "i.dir contains thehere and i.url contains 'developer' and i.layout == 'developer'" -%}
    <span class="badge text-white p-0 m-1">
      <span class="bg-primary py-1 px-2 rounded-left">Забудовників</span>
      <span class="py-1 px-2 bg-info rounded-right">{{ developers | size }}</span>
    </span>
  {%- elsif slug == 'realtor' -%}
    {%- assign realtors = site.html_pages | where_exp: "i", "i.dir contains thehere and i.url contains 'realtor' and i.layout == 'realtor'" -%}
    <span class="badge text-white p-0 m-1">
      <span class="bg-primary py-1 px-2 rounded-left">Aгентів і ріелторів</span>
      <span class="py-1 px-2 bg-info rounded-right">{{ realtors | size }}</span>
    </span>
  {%- endif -%}
{%- endcapture -%}

{%- capture records -%}
  {%- if slug == 'apartment' -%}
    {%- assign oapartment = offers | where_exp: "i", "i.rent != '1' and i.type == 'Квартира' or i.type contains 'квартири' or i.type contains 'Кімната'" -%}
    {{ oapartment | size }}
  {%- elsif slug == 'commercial' -%}
    {%- assign ocommercial = offers | where_exp: "i", "i.rent != '1' and i.type contains 'приміщення' or i.type contains 'Нежитловий'" -%}
    {{ ocommercial | size }}
  {%- elsif slug == 'developer' -%}
    {%- assign odeveloper = offers | where_exp: "i", "i.seller contains 'Будівельна компанія'" -%}
    {{ odeveloper | size }}
  {%- elsif slug == 'garage' -%}
    {%- assign ogarage = offers | where_exp: "i", "i.rent != '1' and i.type == 'Гараж' or i.type contains 'Місце'" -%}
    {{ ogarage | size }}
  {%- elsif slug == 'house' -%}
    {%- assign ohouse = offers | where_exp: "i", "i.rent != '1' and i.type == 'Будинок' or i.type contains 'будинок' or i.type contains 'будинку'" -%}
    {{ ohouse | size }}
  {%- elsif slug == 'land' -%}
    {%- assign oland = offers | where_exp: "i", "i.rent != '1' and i.type == 'Земля'" -%}
    {{ oland | size }}
  {%- elsif slug == 'realtor' -%}
    {%- assign orealtor = offers | where_exp: "i", "i.seller contains 'Агент' or i.seller contains 'Ріелтор'" -%}
    {{ orealtor | size }}
  {%- elsif slug == 'rent' -%}
    {%- assign orent = offers | where_exp: "i", "i.rent == '1'" -%}
    {{ orent | size }}
  {%- else -%}
  {%- endif -%}
{%- endcapture -%}

{%- if page.url contains '/all.html' -%}
  {%- if page.dir == current or one.url contains page.url and page.navhide != 1 -%}
    {%- if one.url contains here and one.url contains 'all.html' and one.navhide != 1 -%}
    {%- else -%}
      <div class="col px-2 mb-3">

        <div class="card">
          <div class="card-body">
            <h5 class="card-title"><a href="{{ one.url }}">{{ navitemtitle }}</a></h5>
          </div>
          <div class="card-footer bg-transparent border-top-0 text-right">
            {%- if nsellers != '' -%}{{ nsellers }}{%- endif -%}
            {%- if ncomplexes != '' -%}{{ ncomplexes }}{%- endif -%}
            {%- if records != '0' -%}
            <span class="badge text-white p-0 m-1">
              <span class="bg-info py-1 px-2 rounded-left">{{ records }}</span>
              <span class="py-1 px-2 bg-primary rounded-right">пропозицій</span>
            </span>
            {%- endif -%}
          </div>
        </div>

{% comment %}

<span class="badge text-white p-0 m-1">
  <span class="bg-primary py-1 px-2 rounded-left">key</span>
  <span class="py-1 px-2 bg-info rounded-right">value</span>
</span>

<span class="badge text-white p-0 m-1">
  <span class="bg-primary py-1 px-2 rounded-left">key</span>
  <span class="py-1 px-2 bg-warning rounded-right">value</span>
</span>

        <div class="card text-white">
          {%- include folder.html dir='/assets/images/section/' slug=slug -%}
          {%- if file == true -%}
            <img loading="lazy" src="{{ picture }}" class="card-img" alt="{{ slug }} - real estate">
          {%- else -%}
            <img src="/assets/images/section/default.jpg" class="card-img" alt="{{ slug }} - real estate">
          {%- endif -%}
          <div class="card-img-overlay">
            <h5 class="card-title text-shadow">
              <a href="{{ one.url }}" class="text-white">{{ navitemtitle }}</a>
            </h5>
            <p class="text-right">
              {%- if nsellers != '' -%}<span class="badge badge-primary mr-2">{{ nsellers }}</span>{%- endif -%}
              {%- if ncomplexes != '' -%}<span class="badge badge-primary mr-2">{{ ncomplexes }}</span>{%- endif -%}
              {%- if records != '0' -%}<span class="badge badge-primary">{{ records }} пропозицій</span>{%- endif -%}
            </p>
          </div>
        </div>
{% endcomment %}

      </div>
    {%- endif -%}
  {%- endif -%}
{%- else -%}

  {%- if one.url contains here and one.url contains 'all.html' and one.navhide != 1 -%}
  {%- else -%}
    {%- if here == current and one.url contains here and one.navhide != 1 -%}
    <div class="col px-2 mb-3">
      <a href="{{ one.url }}" class="nav-link border-0">
        <span>{{ navitemtitle }}</span>
      </a>
    </div>
    {%- endif -%}
  {%- endif -%}

{%- endif -%}
